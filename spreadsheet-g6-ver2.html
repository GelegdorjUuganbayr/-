<!doctype html>
<html lang="mn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>2.2 Creating a Spreadsheet ‚Äî –û–Ω–æ–ª + –î—ç–≤—Ç—ç—Ä–∏–π–Ω –¥–∞—Å–≥–∞–ª + Mini Spreadsheet Simulator</title>
  <style>
    :root{
      --bg:#0b1220;
      --card:#0f1a2f;
      --ink:#eaf1ff;
      --muted:#a9b7d0;
      --border:rgba(255,255,255,.14);
      --accent:#7dd3fc;
      --accent2:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --ok:#22c55e;
      --shadow:0 12px 30px rgba(0,0,0,.35);
      --r:18px;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:
        radial-gradient(1100px 700px at 15% -10%, rgba(125,211,252,.18), transparent 55%),
        radial-gradient(900px 600px at 115% 15%, rgba(52,211,153,.12), transparent 55%),
        var(--bg);
      color: var(--ink);
    }
    .wrap{ max-width: 1100px; margin:0 auto; padding:16px; display:grid; gap:14px; }
    header{
      border:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border-radius: var(--r);
      padding: 14px;
      box-shadow: var(--shadow);
    }
    h1{ margin:0; font-size: clamp(18px, 2.6vw, 28px); }
    .sub{ margin:8px 0 0; color: var(--muted); line-height:1.5; font-size: 14px; }
    .pill{
      display:flex; gap:8px; flex-wrap:wrap; align-items:center;
      margin-top:10px;
    }
    .chip{
      display:inline-flex; gap:8px; align-items:center;
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      border-radius: 999px;
      padding: 6px 10px;
      color: var(--muted);
      font-size: 13px;
      white-space:nowrap;
    }
    .chip.ok{ border-color: rgba(34,197,94,.35); background: rgba(34,197,94,.08); color: rgba(34,197,94,.95); }
    .chip.bad{ border-color: rgba(251,113,133,.35); background: rgba(251,113,133,.08); color: rgba(251,113,133,.95); }

    .card{
      border:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border-radius: var(--r);
      padding: 14px;
      box-shadow: var(--shadow);
    }
    h2{ margin:0 0 8px; font-size: 18px; color: var(--accent); }
    h3{ margin:0 0 8px; font-size: 15px; color: var(--accent2); }
    p{ margin: 8px 0; line-height:1.6; color: var(--muted); }
    ul{ margin: 8px 0 0; padding-left: 18px; color: var(--muted); line-height:1.6; }
    li{ margin: 6px 0; }
    .note{
      border:1px dashed rgba(251,191,36,.55);
      background: rgba(251,191,36,.08);
      border-radius: 14px;
      padding: 10px 12px;
      color: #ffe9a8;
      line-height:1.5;
      font-size: 13px;
      margin-top: 10px;
    }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; color: var(--ink); }
    .tblwrap{
      overflow:auto;
      border-radius: 14px;
      border:1px solid var(--border);
      background: rgba(2,6,23,.35);
      margin-top: 10px;
    }
    table{ width:100%; border-collapse: collapse; min-width: 720px; }
    th,td{ border-bottom:1px solid rgba(255,255,255,.08); padding: 10px; }
    th{
      position: sticky; top:0;
      background: rgba(15,26,47,.92);
      color: var(--muted);
      font-size: 13px;
      text-align:left;
      backdrop-filter: blur(6px);
    }
    td.r, th.r{ text-align:right; }
    .empty{
      display:inline-block;
      min-width: 90px;
      border-bottom: 2px dotted rgba(255,255,255,.35);
      height: 1em;
      vertical-align: baseline;
    }
    .twoCol{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 860px){
      .twoCol{ grid-template-columns: 1fr; }
    }
    .box{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(2,6,23,.25);
      border-radius: 14px;
      padding: 12px;
    }
    .qtitle{
      color: var(--ink);
      font-weight: 900;
      margin: 0 0 6px;
    }
    .checklist li{ margin: 8px 0; }
    hr{ border:none; border-top:1px solid rgba(255,255,255,.10); margin: 12px 0; }

    /* === Mini Spreadsheet Simulator styles === */
    .simGrid{
      display:grid;
      grid-template-columns: 52px repeat(6, minmax(84px, 1fr));
      overflow:auto;
      border:1px solid var(--border);
      border-radius: 14px;
      background: rgba(2,6,23,.35);
      min-width: 700px;
    }
    .corner, .colH, .rowH{
      padding: 8px 8px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      border-right: 1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.02);
      color: var(--muted);
      font-weight: 900;
      font-size: 12px;
      text-align:center;
      position: sticky;
      z-index: 2;
    }
    .corner{ top:0; left:0; z-index: 4; }
    .colH{ top:0; z-index: 3; }
    .rowH{ left:0; z-index: 3; }

    .cellBox{
      border-bottom: 1px solid rgba(255,255,255,.08);
      border-right: 1px solid rgba(255,255,255,.08);
      padding: 6px;
      background: rgba(2,6,23,.18);
    }
    .cellBtn{
      width:100%;
      padding: 10px 10px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(2,6,23,.30);
      color: var(--ink);
      cursor:pointer;
      text-align:left;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .cellBtn:hover{ background: rgba(255,255,255,.06); }
    .cellBtn.active{
      border-color: rgba(125,211,252,.75);
      box-shadow: 0 0 0 3px rgba(125,211,252,.12);
    }
    .cellVal{
      overflow:hidden; text-overflow: ellipsis; white-space: nowrap;
      max-width: 100%;
      font-weight: 800;
    }
    .cellHint{
      color: var(--muted);
      font-size: 11px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      opacity: .9;
      white-space: nowrap;
    }

    .simTop{
      display:flex; gap:10px; align-items:center; justify-content:space-between;
      flex-wrap:wrap;
      margin-top: 10px;
    }
    .formulaBar{
      display:flex; gap:10px; align-items:center; flex-wrap:wrap;
      border:1px solid var(--border);
      background: rgba(2,6,23,.30);
      border-radius: 14px;
      padding: 10px;
    }
    .addr{
      padding: 6px 10px;
      border-radius: 999px;
      border:1px solid var(--border);
      background: rgba(125,211,252,.10);
      color: var(--accent);
      font-weight: 900;
      font-size: 13px;
      white-space: nowrap;
    }
    .formulaInput{
      flex: 1;
      min-width: 240px;
      padding: 10px 12px;
      border-radius: 12px;
      border:1px solid var(--border);
      background: rgba(2,6,23,.45);
      color: var(--ink);
      outline:none;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 13px;
    }
    .formulaInput:focus{
      border-color: rgba(125,211,252,.65);
      box-shadow: 0 0 0 3px rgba(125,211,252,.12);
    }
    .btnrow{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    button{
      border:1px solid var(--border);
      background: rgba(125,211,252,.12);
      color: var(--ink);
      padding: 10px 12px;
      border-radius: 12px;
      cursor:pointer;
      font-weight: 900;
    }
    button:hover{ background: rgba(125,211,252,.18); }
    button.secondary{ background: rgba(255,255,255,.05); }
    button.secondary:hover{ background: rgba(255,255,255,.08); }
    button.danger{ background: rgba(251,113,133,.10); border-color: rgba(251,113,133,.35); }
    button.danger:hover{ background: rgba(251,113,133,.15); }

    .msg{
      margin-top: 10px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(2,6,23,.30);
      border-radius: 14px;
      padding: 10px 12px;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.5;
    }
    .msg.ok{ border-color: rgba(34,197,94,.35); background: rgba(34,197,94,.08); color: rgba(34,197,94,.95); }
    .msg.bad{ border-color: rgba(251,113,133,.35); background: rgba(251,113,133,.08); color: rgba(251,113,133,.95); }

    /* Print-friendly */
    @media print{
      body{ background:#fff; color:#000; }
      header,.card,.box,.tblwrap,.simGrid,.formulaBar,.msg{ background:#fff !important; color:#000 !important; border:1px solid #ccc !important; box-shadow:none !important; }
      h2,h3{ color:#000 !important; }
      p,ul,li,.sub,.chip,.note{ color:#000 !important; }
      .mono,.cellHint,.cellVal{ color:#000 !important; }
      th{ background:#eee !important; color:#000 !important; }
      .note{ border:1px dashed #999 !important; }
      .empty{ border-bottom: 2px dotted #000 !important; }
      button{ display:none !important; } /* print –¥—ç—ç—Ä —Ç–æ–≤—á —Ö—ç—Ä—ç–≥–≥“Ø–π */
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <h1>2.2 Creating a Spreadsheet ‚Äî –û–Ω–æ–ª + –î—ç–≤—Ç—ç—Ä–∏–π–Ω –¥–∞—Å–≥–∞–ª + Simulator</h1>
      <p class="sub">
        –≠—Ö—ç–Ω–¥ –Ω—å —Ö“Ø“Ø—Ö–¥“Ø“Ø–¥ –¥—ç–≤—Ç—ç—Ä –¥—ç—ç—Ä—ç—ç —Ö“Ø—Å–Ω—ç–≥—Ç –∑—É—Ä–∞–∞–¥ –±–æ–¥–Ω–æ. –°“Ø“Ø–ª–¥ –Ω—å ‚ÄúMini Spreadsheet Simulator‚Äù-—Ç –æ—Ä–∂
        <b>=</b>, <b>cell reference</b>, <b>*</b>, <b>SUM</b>, <b>AVERAGE</b>-–≥ –±–æ–¥–∏—Ç–æ–æ—Ä —Ç—É—Ä—à–∏–Ω–∞.
      </p>
      <div class="pill">
        <span class="chip">üìù –î—ç–≤—Ç—ç—Ä –¥—ç—ç—Ä –±–æ–¥–Ω–æ</span>
        <span class="chip">‚úÖ –ê–ª—Ö–∞–º –∞–ª—Ö–º–∞–∞—Ä</span>
        <span class="chip ok">üß™ –°“Ø“Ø–ª–¥ –Ω—å —Ç—É—Ä—à–∏–Ω–∞ (simulator)</span>
      </div>
    </header>

    <section class="card">
      <h2>1) –û–ù–û–õ ‚Äî –ì–æ–ª –æ–π–ª–≥–æ–ª—Ç—É—É–¥</h2>
      <div class="twoCol">
        <div class="box">
          <h3>–•“Ø—Å–Ω—ç–≥—Ç (Spreadsheet)</h3>
          <ul>
            <li>–•“Ø—Å–Ω—ç–≥—Ç –±–æ–ª –º”©—Ä (row) –±–∞ –±–∞–≥–∞–Ω–∞ (column)-–∞–∞—Å –±“Ø—Ä–¥—ç—Ö —Ç–æ—Ä.</li>
            <li>–¢–æ—Ä–Ω—ã –Ω—ç–≥ —Ö–∞–π—Ä—Ü–∞–≥ = <b>–Ω“Ø–¥ (cell)</b>.</li>
            <li>–ú”©—Ä –Ω—å —Ç–æ–æ–≥–æ–æ—Ä (1,2,3...), –±–∞–≥–∞–Ω–∞ –Ω—å “Ø—Å–≥—ç—ç—Ä (A,B,C...) –Ω—ç—Ä–ª—ç–≥–¥—ç–Ω—ç.</li>
          </ul>
        </div>
        <div class="box">
          <h3>–ù“Ø–¥–Ω–∏–π —Ö–∞—è–≥ (Cell reference)</h3>
          <ul>
            <li>–ù“Ø–¥–Ω–∏–π —Ö–∞—è–≥ = <b>“Ø—Å—ç–≥ + —Ç–æ–æ</b> (–∂–∏—à—ç—ç: <span class="mono">B3</span>).</li>
            <li><span class="mono">B</span> –Ω—å –±–∞–≥–∞–Ω–∞, <span class="mono">3</span> –Ω—å –º”©—Ä.</li>
            <li>–¢–æ–æ—Ü–æ–æ–ª–æ–ª–¥ –Ω“Ø–¥–Ω–∏–π —Ö–∞—è–≥ –∞—à–∏–≥–ª–∞–≤–∞–ª ”©–≥”©–≥–¥”©–ª ”©”©—Ä—á–ª”©–≥–¥”©—Ö”©–¥ —Ö–∞—Ä–∏—É –∞–≤—Ç–æ–º–∞—Ç–∞–∞—Ä ”©”©—Ä—á–ª”©–≥–¥”©–Ω”©.</li>
          </ul>
        </div>
      </div>

      <div class="twoCol" style="margin-top:12px;">
        <div class="box">
          <h3>–¢–æ–º—å—ë–æ (Formula)</h3>
          <ul>
            <li>–¢–æ–º—å—ë–æ –±–æ–ª —Ç–æ–æ—Ü–æ–æ–ª–æ—Ö –∑–∞–∞–≤–∞—Ä.</li>
            <li>–¢–æ–º—å—ë–æ <b>–∑–∞–∞–≤–∞–ª</b> <span class="mono">=</span>-—ç—ç—Ä —ç—Ö—ç–ª–Ω—ç.</li>
            <li>–û–ø–µ—Ä–∞—Ç–æ—Ä—É—É–¥: <span class="mono">+ - * /</span></li>
            <li>–ñ–∏—à—ç—ç: <span class="mono">=B2*C2</span> (“Ø—Ä–∂–∏—Ö).</li>
          </ul>
          <div class="note">
            –°–∞–Ω—É—É–ª–≥–∞: ‚Äú–ù–∏–π—Ç‚Äù –∏—Ö—ç–≤—á–ª—ç–Ω <b>“Æ–Ω—ç √ó –¢–æ–æ</b> –±–∞–π–¥–∞–≥.
          </div>
        </div>

        <div class="box">
          <h3>–§—É–Ω–∫—Ü (Function)</h3>
          <ul>
            <li><b>SUM</b> ‚Äî –Ω–∏–π–ª–±—ç—Ä: <span class="mono">=SUM(D2:D6)</span></li>
            <li><b>AVERAGE</b> ‚Äî –¥—É–Ω–¥–∞–∂: <span class="mono">=AVERAGE(B2:B6)</span></li>
            <li><span class="mono">:</span> —Ç—ç–º–¥—ç–≥ –Ω—å ‚Äú-–∞–∞—Å - —Ö“Ø—Ä—Ç—ç–ª‚Äù –≥—ç—Å—ç–Ω —É—Ç–≥–∞—Ç–∞–π.</li>
          </ul>
        </div>
      </div>
    </section>

    <section class="card">
      <h2>2) –ñ–∏—à—ç—ç —Ö“Ø—Å–Ω—ç–≥—Ç (–¥—ç–≤—Ç—ç—Ä –¥—ç—ç—Ä—ç—ç —Ö—É—É–ª–∂ –∑—É—Ä)</h2>
      <p>
        –î—ç–≤—Ç—ç—Ä –¥—ç—ç—Ä—ç—ç –º”©—Ä, –±–∞–≥–∞–Ω—ã –Ω—ç—Ä–∏–π–≥ –∑–∞–∞–≤–∞–ª –±–∏—á. –î–∞—Ä–∞–∞ –Ω—å D –±–∞–≥–∞–Ω—ã–Ω ‚Äú–ù–∏–π—Ç‚Äù-–∏–π–≥ –±–æ–¥–æ–∂ –±”©–≥–ª”©–Ω”©.
      </p>

      <div class="tblwrap">
        <table aria-label="Example spreadsheet">
          <thead>
            <tr>
              <th class="r"> </th>
              <th>A (–ë–∞—Ä–∞–∞)</th>
              <th class="r">B (“Æ–Ω—ç ‚ÇÆ)</th>
              <th class="r">C (–¢–æ–æ —à)</th>
              <th class="r">D (–ù–∏–π—Ç ‚ÇÆ)</th>
            </tr>
          </thead>
          <tbody>
            <tr><td class="r">1</td><td><b>Stationery Shop</b></td><td class="r"> </td><td class="r"> </td><td class="r"> </td></tr>
            <tr><td class="r">2</td><td>Pens (“Æ–∑—ç–≥)</td><td class="r">800</td><td class="r">12</td><td class="r"><span class="empty"></span></td></tr>
            <tr><td class="r">3</td><td>Pencils (–•–∞—Ä–∞–Ω–¥–∞–∞)</td><td class="r">500</td><td class="r">20</td><td class="r"><span class="empty"></span></td></tr>
            <tr><td class="r">4</td><td>Notebooks (–î—ç–≤—Ç—ç—Ä)</td><td class="r">2500</td><td class="r">7</td><td class="r"><span class="empty"></span></td></tr>
            <tr><td class="r">5</td><td>Erasers (–ë–∞–ª–ª—É—É—Ä)</td><td class="r">300</td><td class="r">15</td><td class="r"><span class="empty"></span></td></tr>
            <tr><td class="r">6</td><td>Rulers (–®—É–≥–∞–º)</td><td class="r">1200</td><td class="r">5</td><td class="r"><span class="empty"></span></td></tr>
            <tr><td class="r">7</td><td><b>–ë“Ø—Ö –±–∞—Ä–∞–∞–Ω—ã –Ω–∏–π—Ç</b></td><td class="r"> </td><td class="r"> </td><td class="r"><span class="empty"></span></td></tr>
            <tr><td class="r">8</td><td><b>–î—É–Ω–¥–∞–∂ “Ø–Ω—ç</b></td><td class="r"><span class="empty"></span></td><td class="r"> </td><td class="r"> </td></tr>
          </tbody>
        </table>
      </div>

      <div class="note">
        –ì–æ–ª –¥“Ø—Ä—ç–º: <b>D2 = B2*C2</b>, <b>D3 = B3*C3</b> ... (–ù–∏–π—Ç = “Æ–Ω—ç √ó –¢–æ–æ)
      </div>
    </section>

    <section class="card">
      <h2>3) –î—ç–≤—Ç—ç—Ä –¥—ç—ç—Ä —Ö–∏–π—Ö –¥–∞—Å–≥–∞–ª—É—É–¥ (–∞–ª—Ö–∞–º –∞–ª—Ö–º–∞–∞—Ä)</h2>

      <div class="box">
        <p class="qtitle">–î–∞—Å–≥–∞–ª 1 ‚Äî –ù“Ø–¥–Ω–∏–π —Ö–∞—è–≥ (Cell reference)</p>
        <ul class="checklist">
          <li>1) ‚ÄúNotebooks (–î—ç–≤—Ç—ç—Ä)‚Äù –º”©—Ä —Ö—ç–¥ –≤—ç? ‚Üí <span class="empty"></span></li>
          <li>2) ‚ÄúNotebooks‚Äù-–∏–π–Ω “Ø–Ω—ç –∞–ª—å –Ω“Ø–¥ –≤—ç? ‚Üí <span class="empty"></span></li>
          <li>3) ‚ÄúRulers‚Äù-–∏–π–Ω —Ç–æ–æ –∞–ª—å –Ω“Ø–¥ –≤—ç? ‚Üí <span class="empty"></span></li>
          <li>4) ‚ÄúPens‚Äù-–∏–π–Ω –Ω–∏–π—Ç –≥–∞—Ä–∞—Ö –Ω“Ø–¥ –∞–ª—å –≤—ç? ‚Üí <span class="empty"></span></li>
        </ul>
      </div>

      <hr/>

      <div class="box">
        <p class="qtitle">–î–∞—Å–≥–∞–ª 2 ‚Äî –ù–∏–π—Ç (Total) –±–æ–¥–æ—Ö (“Ø—Ä–∂–∏—Ö)</p>
        <p>–î–∞—Ä–∞–∞—Ö—ã–≥ –±–æ–¥–æ–æ–¥ —Ö“Ø—Å–Ω—ç–≥—Ç–∏–π–Ω D –±–∞–≥–∞–Ω–∞–¥ –±”©–≥–ª”©”©—Ä—ç–π.</p>
        <ul class="checklist">
          <li>D2 = 800 √ó 12 = <span class="empty"></span></li>
          <li>D3 = 500 √ó 20 = <span class="empty"></span></li>
          <li>D4 = 2500 √ó 7 = <span class="empty"></span></li>
          <li>D5 = 300 √ó 15 = <span class="empty"></span></li>
          <li>D6 = 1200 √ó 5 = <span class="empty"></span></li>
        </ul>
      </div>

      <hr/>

      <div class="box">
        <p class="qtitle">–î–∞—Å–≥–∞–ª 3 ‚Äî –¢–æ–º—å—ë–æ–≥ ‚Äú“Ø—Å–≥—ç—ç—Ä‚Äù –±–∏—á–∏—Ö (—Ç–æ–æ—Ü–æ–æ–ª–æ—Ö–≥“Ø–π)</p>
        <p>–î–æ–æ—Ä—Ö –Ω“Ø–¥—ç–Ω–¥ —è–º–∞—Ä —Ç–æ–º—å—ë–æ –±–∏—á–∏—Ö –≤—ç? <b>–ó”©–≤—Ö”©–Ω —Ç–æ–º—å—ë–æ–≥</b> –±–∏—á.</p>
        <ul class="checklist">
          <li>Pens-–∏–π–Ω –Ω–∏–π—Ç (D2) = <span class="mono">=</span><span class="empty"></span></li>
          <li>Pencils-–∏–π–Ω –Ω–∏–π—Ç (D3) = <span class="mono">=</span><span class="empty"></span></li>
          <li>Notebooks-–∏–π–Ω –Ω–∏–π—Ç (D4) = <span class="mono">=</span><span class="empty"></span></li>
        </ul>
        <div class="note">–°–∞–Ω–∞–º–∂: –ù–∏–π—Ç = “Æ–Ω—ç √ó –¢–æ–æ. “Æ—Ä–∂–∏—Ö —Ç—ç–º–¥—ç–≥ –Ω—å <span class="mono">*</span>.</div>
      </div>

      <hr/>

      <div class="box">
        <p class="qtitle">–î–∞—Å–≥–∞–ª 4 ‚Äî –ë“Ø—Ö –±–∞—Ä–∞–∞–Ω—ã –Ω–∏–π—Ç (SUM)</p>
        <ul class="checklist">
          <li>1) D7 –Ω“Ø–¥—ç–Ω–¥ –±–∏—á–∏—Ö —Ç–æ–º—å—ë–æ: <span class="mono">=</span><span class="empty" style="min-width:220px;"></span></li>
          <li>2) –î–∞—Å–≥–∞–ª 2-—ã–Ω D2‚ÄìD6 —É—Ç–≥—É—É–¥—ã–≥ –Ω—ç–º–∂ D7 –¥—ç—ç—Ä ‚Äú–Ω–∏–π—Ç‚Äù-”©”© –±–∏—á.</li>
        </ul>
      </div>

      <hr/>

      <div class="box">
        <p class="qtitle">–î–∞—Å–≥–∞–ª 5 ‚Äî –î—É–Ω–¥–∞–∂ “Ø–Ω—ç (AVERAGE)</p>
        <ul class="checklist">
          <li>1) B8 –Ω“Ø–¥—ç–Ω–¥ –±–∏—á–∏—Ö —Ç–æ–º—å—ë–æ: <span class="mono">=</span><span class="empty" style="min-width:220px;"></span></li>
          <li>2) B2‚ÄìB6 “Ø–Ω–∏–π–Ω –Ω–∏–π–ª–±—ç—Ä–∏–π–≥ –æ–ª: <span class="empty"></span></li>
          <li>3) –¢—ç—Ä –Ω–∏–π–ª–±—ç—Ä—ç—ç 5-–¥ —Ö—É–≤–∞–∞–≥–∞–∞–¥ –¥—É–Ω–¥–∞–∂–∏–π–≥ –æ–ª: <span class="empty"></span></li>
        </ul>
      </div>
    </section>

    <!-- ‚úÖ Requested: small working simulator at the end -->
    <section class="card" id="sim">
      <h2>4) Mini Spreadsheet Simulator (–∞–∂–∏–ª–ª–∞–¥–∞–≥)</h2>
      <p>
        –û–¥–æ–æ “Ø–∑—Å—ç–Ω –∑“Ø–π–ª—Å—ç—ç —ç–Ω–¥ —Ç—É—Ä—à: –Ω“Ø–¥ —Å–æ–Ω–≥–æ–æ–¥ –¥—ç—ç—Ä—Ö –º”©—Ä”©–Ω–¥ —Ç–æ–º—å—ë–æ –±–∏—á–Ω—ç.
        –î—ç–º–∂–∏—Ö: <span class="mono">=</span>, <span class="mono">+ - * / ( )</span>, <span class="mono">SUM(A1:A5)</span>, <span class="mono">AVERAGE(B2:B6)</span>.
      </p>

      <div class="note">
        –¢“Ø—Ä–≥—ç–Ω —Ç—É—Ä—à–∏–ª—Ç:
        <ul style="margin:8px 0 0; padding-left:18px;">
          <li>A2..A6 –¥—ç—ç—Ä —Ç–æ–æ –æ—Ä—É—É–ª–∞–∞–¥ A7 –¥—ç—ç—Ä <span class="mono">=SUM(A2:A6)</span></li>
          <li>B2..B6 –¥—ç—ç—Ä —Ç–æ–æ –æ—Ä—É—É–ª–∞–∞–¥ B7 –¥—ç—ç—Ä <span class="mono">=AVERAGE(B2:B6)</span></li>
          <li>C2 –¥—ç—ç—Ä 7, D2 –¥—ç—ç—Ä 6 –±–∏—á—ç—ç–¥ E2 –¥—ç—ç—Ä <span class="mono">=C2*D2</span></li>
        </ul>
      </div>

      <div class="simTop">
        <div class="formulaBar">
          <span class="addr" id="addr">A1</span>
          <input class="formulaInput" id="bar" placeholder="–ñ–∏—à—ç—ç: =SUM(A2:A6)" />
          <button id="apply">–•—ç—Ä—ç–≥–ª—ç—Ö</button>
        </div>

        <div class="btnrow">
          <button class="secondary" id="seed">–ñ–∏—à—ç—ç ”©–≥”©–≥–¥”©–ª</button>
          <button class="danger" id="clear">–¶—ç–≤—ç—Ä–ª—ç—Ö</button>
        </div>
      </div>

      <div class="tblwrap" style="margin-top:12px;">
        <div class="simGrid" id="grid"></div>
      </div>

      <div class="msg" id="status" style="display:none;"></div>
    </section>

  </div>

  <script>
    /***********************
     * Mini Spreadsheet Simulator
     * - Grid: A..F, 1..8
     * - Each cell stores raw input: "12" or "=A1+A2" etc.
     * - Supports: + - * / ( )
     * - Functions: SUM(range), AVERAGE(range)
     * - Range supports rectangles: A2:B4
     ***********************/
    const cols = ["A","B","C","D","E","F"];
    const rows = [1,2,3,4,5,6,7,8];

    const $ = (s, el=document)=> el.querySelector(s);
    const $$ = (s, el=document)=> Array.from(el.querySelectorAll(s));

    const stateKey = "mini_sheet_v1_mn";

    function addr(c,r){ return `${c}${r}`; }
    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")
        .replaceAll('"',"&quot;").replaceAll("'","&#039;");
    }
    function fmt(n){
      if(!Number.isFinite(n)) return "‚Äî";
      const nearInt = Math.abs(n - Math.round(n)) < 1e-9;
      return nearInt ? String(Math.round(n)) : n.toFixed(2);
    }

    // sheet[id] = { raw: string, val: number|string }
    let sheet = {};
    let active = { c:"A", r:1 };

    function defaultSheet(){
      const s = {};
      cols.forEach(c => rows.forEach(r => s[addr(c,r)] = { raw:"", val:"" }));
      return s;
    }

    function load(){
      const raw = localStorage.getItem(stateKey);
      try{ sheet = raw ? JSON.parse(raw) : defaultSheet(); }
      catch(e){ sheet = defaultSheet(); }
    }
    function save(){
      localStorage.setItem(stateKey, JSON.stringify(sheet));
    }

    function setStatus(text, type){
      const el = $("#status");
      el.style.display = "block";
      el.classList.remove("ok","bad");
      if(type) el.classList.add(type);
      el.textContent = text;
    }

    function setActive(c,r){
      active = {c,r};
      $("#addr").textContent = addr(c,r);
      $("#bar").value = (sheet[addr(c,r)]?.raw ?? "");
      $$(".cellBtn", $("#grid")).forEach(b => b.classList.remove("active"));
      const btn = $(`#btn_${addr(c,r)}`);
      if(btn) btn.classList.add("active");
    }

    function parseRange(rangeStr){
      // "A2:B4" or "C3:C6"
      const m = rangeStr.match(/^([A-F])([1-8])\s*:\s*([A-F])([1-8])$/i);
      if(!m) return [];
      const c1 = m[1].toUpperCase(), r1 = Number(m[2]);
      const c2 = m[3].toUpperCase(), r2 = Number(m[4]);
      const cStart = Math.min(cols.indexOf(c1), cols.indexOf(c2));
      const cEnd   = Math.max(cols.indexOf(c1), cols.indexOf(c2));
      const rStart = Math.min(r1, r2);
      const rEnd   = Math.max(r1, r2);
      const out = [];
      for(let rr=rStart; rr<=rEnd; rr++){
        for(let cc=cStart; cc<=cEnd; cc++){
          out.push(addr(cols[cc], rr));
        }
      }
      return out;
    }

    function getCellNumber(id){
      const raw = (sheet[id]?.raw ?? "").trim();
      if(raw === "") return 0;
      if(raw.startsWith("=")){
        const v = Number(sheet[id]?.val);
        return Number.isFinite(v) ? v : 0;
      }
      const n = Number(raw);
      return Number.isFinite(n) ? n : 0;
    }

    function evalFormula(formula){
      // formula starts with "="
      let expr = formula.trim().slice(1);

      // Replace SUM(...) and AVERAGE(...), repeat a few times (simple nesting)
      const funcPattern = /(SUM|AVERAGE)\s*\(\s*([A-F][1-8]\s*:\s*[A-F][1-8])\s*\)/ig;
      let guard = 0;
      while(funcPattern.test(expr) && guard < 20){
        expr = expr.replace(funcPattern, (full, fn, range) => {
          const ids = parseRange(range.replace(/\s+/g,""));
          const nums = ids.map(getCellNumber);
          const sum = nums.reduce((a,b)=>a+b,0);
          if(String(fn).toUpperCase() === "SUM") return String(sum);
          const avg = nums.length ? (sum / nums.length) : 0;
          return String(avg);
        });
        guard++;
      }

      // Replace cell refs like A1
      expr = expr.replace(/([A-F])([1-8])/g, (m,c,r)=>{
        const id = addr(String(c).toUpperCase(), Number(r));
        return String(getCellNumber(id));
      });

      // Validate remaining characters
      if(!/^[0-9+\-*/().\s]+$/.test(expr)){
        throw new Error("–î—ç–º–∂–∏–≥–¥—ç—ç–≥“Ø–π —Ç—ç–º–¥—ç–≥ –±–∞–π–Ω–∞ (–∑”©–≤—Ö”©–Ω + - * / ( ) –±–æ–ª–æ–Ω SUM/AVERAGE range –∞—à–∏–≥–ª–∞–Ω–∞).");
      }

      // Evaluate expression
      // eslint-disable-next-line no-new-func
      const v = Function(`"use strict"; return (${expr});`)();
      if(!Number.isFinite(v)) throw new Error("–¢–æ–æ—Ü–æ–æ–ª–æ–ª –±–æ–ª–æ–º–∂–≥“Ø–π (Infinity —ç—Å–≤—ç–ª NaN).");
      return v;
    }

    function recalc(){
      // do multiple passes for dependencies
      for(let pass=0; pass<6; pass++){
        for(const id of Object.keys(sheet)){
          const raw = (sheet[id].raw ?? "").trim();
          if(raw.startsWith("=")){
            try{
              sheet[id].val = evalFormula(raw);
            }catch(e){
              sheet[id].val = "";
            }
          }else{
            sheet[id].val = "";
          }
        }
      }
      save();
      render();
    }

    function render(){
      const grid = $("#grid");
      grid.innerHTML = "";

      // corner
      const corner = document.createElement("div");
      corner.className = "corner";
      corner.textContent = "";
      grid.appendChild(corner);

      // column headers
      cols.forEach(c=>{
        const h = document.createElement("div");
        h.className = "colH";
        h.textContent = c;
        grid.appendChild(h);
      });

      // rows + cells
      rows.forEach(r=>{
        const rh = document.createElement("div");
        rh.className = "rowH";
        rh.textContent = r;
        grid.appendChild(rh);

        cols.forEach(c=>{
          const id = addr(c,r);
          const cell = sheet[id] || { raw:"", val:"" };

          const box = document.createElement("div");
          box.className = "cellBox";

          const btn = document.createElement("button");
          btn.type = "button";
          btn.className = "cellBtn";
          btn.id = `btn_${id}`;
          btn.addEventListener("click", ()=> setActive(c,r));

          const raw = (cell.raw ?? "").trim();
          const display = raw.startsWith("=")
            ? (cell.val === "" ? "‚Äî" : fmt(Number(cell.val)))
            : (raw === "" ? "‚Äî" : raw);

          const hint = raw.startsWith("=") ? raw : "—É—Ç–≥–∞";

          btn.innerHTML = `
            <span class="cellVal">${escapeHtml(display)}</span>
            <span class="cellHint">${escapeHtml(hint)}</span>
          `;

          box.appendChild(btn);
          grid.appendChild(box);
        });
      });

      setActive(active.c, active.r);
    }

    function apply(){
      const id = addr(active.c, active.r);
      sheet[id] = sheet[id] || { raw:"", val:"" };
      sheet[id].raw = $("#bar").value;
      try{
        recalc();
        setStatus("–•–∞–¥–≥–∞–ª–ª–∞–∞. (Enter –¥–∞—Ä–∂ –±–∞—Å –±–æ–ª–Ω–æ)", "ok");
      }catch(e){
        setStatus(String(e?.message || e), "bad");
      }
    }

    // Buttons + events
    $("#apply").addEventListener("click", apply);
    $("#bar").addEventListener("keydown", (e)=>{
      if(e.key === "Enter"){
        e.preventDefault();
        apply();
      }
    });

    $("#seed").addEventListener("click", ()=>{
      // Small demo aligned with lesson: totals + sum + average
      const seed = {
        A2:"10", A3:"12", A4:"8", A5:"15", A6:"5",
        A7:"=SUM(A2:A6)",
        B2:"800", B3:"500", B4:"2500", B5:"300", B6:"1200",
        B7:"=AVERAGE(B2:B6)",
        C2:"7", D2:"6", E2:"=C2*D2"
      };
      for(const k of Object.keys(seed)){
        if(sheet[k]) sheet[k].raw = seed[k];
      }
      recalc();
      setActive("A",7);
      setStatus("–ñ–∏—à—ç—ç ”©–≥”©–≥–¥”©–ª –æ—Ä—É—É–ª–ª–∞–∞. –û–¥–æ–æ ”©”©—Ä—á–ª”©”©–¥ —Ç—É—Ä—à–∞–∞—Ä–∞–π.", "ok");
    });

    $("#clear").addEventListener("click", ()=>{
      sheet = defaultSheet();
      save();
      render();
      setActive("A",1);
      setStatus("–¶—ç–≤—ç—Ä–ª—ç–≥–¥–ª—ç—ç.", "ok");
    });

    // Init
    load();
    render();
    setStatus("–ù“Ø–¥ —Å–æ–Ω–≥–æ–æ–¥ –¥—ç—ç—Ä—Ö –º”©—Ä”©–Ω–¥ —É—Ç–≥–∞ —ç—Å–≤—ç–ª —Ç–æ–º—å—ë–æ –±–∏—á. –ñ: =B2*C2", "ok");
  </script>
</body>
</html>